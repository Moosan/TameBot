# スプシ連携用 App Script

TameBot がリアクション集計結果とメンバー一覧を送信する先の API です。

## セットアップ

1. **スプレッドシートを作成**
   - [Google スプレッドシート](https://sheets.google.com) で新規作成

2. **Apps Script を開く**
   - 拡張機能 → Apps Script

3. **`Main.gs` の内容を貼り付け**
   - このリポジトリの `appscript/Main.gs` をコピーし、デフォルトの `Code.gs` を置き換え

4. **デプロイ**
   - デプロイ → 新しいデプロイ → 種類は「ウェブアプリ」
   - 説明: 任意（例: `TameBot 連携`）
   - 実行ユーザー: **自分**
   - アクセス: **全員**（匿名含む。Bot が外部から POST するため）
   - デプロイをクリック

5. **URL を控える**
   - デプロイ後表示される「ウェブアプリの URL」をコピー
   - Bot の環境変数 `SPREADSHEET_API_URL` に設定

## シート構成

- **シート1**（名前は `SHEET1_NAME` またはリクエストの `sheet1Name`）
  - 列: メンバー名 | 出席/欠席/未入力 | ロール

- **シート2**（名前は `SHEET2_NAME` または `sheet2Name`）
  - 列: 項目 | 値（イケケモ, 案内, サクラ, スタッフ, ゲスト, インスタンス）

シートが無ければ自動作成されます。
